<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Effect of a feature on predictions — FeatureEffect • iml</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Effect of a feature on predictions — FeatureEffect"><meta property="og:description" content="FeatureEffect computes and plots (individual) feature effects
of prediction models."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">iml</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/intro.html">Introduction to iml: Interpretable Machine Learning in R</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallel computation of interpretation methods</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/christophM/iml/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Effect of a feature on predictions</h1>
    <small class="dont-index">Source: <a href="https://github.com/christophM/iml/blob/HEAD/R/FeatureEffect.R" class="external-link"><code>R/FeatureEffect.R</code></a></small>
    <div class="hidden name"><code>FeatureEffect.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>FeatureEffect</code> computes and plots (individual) feature effects
of prediction models.</p>
    </div>


    <div id="details">
    <h2>Details</h2>
    <p>The FeatureEffect class compute the effect a feature has on the prediction.
Different methods are implemented:</p><ul><li><p>Accumulated Local Effect (ALE) plots</p></li>
<li><p>Partial Dependence Plots (PDPs)</p></li>
<li><p>Individual Conditional Expectation (ICE) curves</p></li>
</ul><p>Accumulated local effects and partial dependence plots both show the average
model prediction over the feature. The difference is that ALE are computed as
accumulated differences over the conditional distribution and partial
dependence plots over the marginal distribution. ALE plots preferable to
PDPs, because they are faster and unbiased when features are correlated.</p>
<p>ALE plots for categorical features are automatically ordered by the
similarity of the categories based on the distribution of the other features
for instances in a category. When the feature is an ordered factor, the ALE
plot leaves the order as is.</p>
<p>Individual conditional expectation curves describe how, for a single
observation, the prediction changes when the feature changes and can be
combined with partial dependence plots.</p>
<p>To learn more about accumulated local effects, read the <a href="https://christophm.github.io/interpretable-ml-book/ale.html" class="external-link">Interpretable Machine Learning book</a>.</p>
<p>For the partial dependence plots:
<a href="https://christophm.github.io/interpretable-ml-book/pdp.html" class="external-link">https://christophm.github.io/interpretable-ml-book/pdp.html</a></p>
<p>For individual conditional expectation:
<a href="https://christophm.github.io/interpretable-ml-book/ice.html" class="external-link">https://christophm.github.io/interpretable-ml-book/ice.html</a></p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Apley, D. W. 2016. "Visualizing the Effects of Predictor Variables in Black
Box Supervised Learning Models." ArXiv Preprint.</p>
<p>Friedman, J.H. 2001. "Greedy Function Approximation: A Gradient Boosting
Machine." Annals of Statistics 29: 1189-1232.</p>
<p>Goldstein, A., Kapelner, A., Bleich, J., and Pitkin, E. (2013). Peeking
Inside the Black Box: Visualizing Statistical Learning with Plots of
Individual Conditional Expectation, 1-22.
https://doi.org/10.1080/10618600.2014.907095</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="plot.FeatureEffect.html">plot.FeatureEffect</a></p></div>
    </div>
    <div id="super-class">
    <h2>Super class</h2>
    <p><code><a href="InterpretationMethod.html">iml::InterpretationMethod</a></code> -&gt; <code>FeatureEffect</code></p>
    </div>
    <div id="public-fields">
    <h2>Public fields</h2>
    <p></p><div class="r6-fields"><dl><dt><code>grid.size</code></dt>
<dd><p>(<code>numeric(1)</code> | <code>numeric(2)</code>)<br>
The size of the grid.</p></dd>


<dt><code>feature.name</code></dt>
<dd><p>(<code>character(1)</code> | <code>character(2)</code>)<br>
The names of the features for which the partial dependence was computed.</p></dd>


<dt><code>n.features</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
The number of features (either 1 or 2).</p></dd>


<dt><code>feature.type</code></dt>
<dd><p>(<code>character(1)</code> | <code>character(2)</code>)<br>
The detected types of the features, either "categorical" or "numerical".</p></dd>


<dt><code>method</code></dt>
<dd><p>(<code>character(1)</code>)<br></p></dd>


</dl><p></p></div>
    </div>
    <div id="active-bindings">
    <h2>Active bindings</h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>center.at</code></dt>
<dd><p><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a><br>
Value at which the plot was centered. Ignored in the case of two
features.</p></dd>


</dl><p></p></div>
    </div>
    <div id="methods">
    <h2>Methods</h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-new"><code>FeatureEffect$new()</code></a></p></li>
<li><p><a href="#method-set.feature"><code>FeatureEffect$set.feature()</code></a></p></li>
<li><p><a href="#method-center"><code>FeatureEffect$center()</code></a></p></li>
<li><p><a href="#method-predict"><code>FeatureEffect$predict()</code></a></p></li>
<li><p><a href="#method-clone"><code>FeatureEffect$clone()</code></a></p></li>
</ul></div><p><details open><summary>Inherited methods</summary><ul><li><p><span class="pkg-link" data-pkg="iml" data-topic="InterpretationMethod" data-id="plot"><a href="InterpretationMethod.html#method-plot"><code>iml::InterpretationMethod$plot()</code></a></span></p></li>
<li><p><span class="pkg-link" data-pkg="iml" data-topic="InterpretationMethod" data-id="print"><a href="InterpretationMethod.html#method-print"><code>iml::InterpretationMethod$print()</code></a></span></p></li>
</ul></details></p><hr><a id="method-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create a FeatureEffect object</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span class="va"><a href="../reference/FeatureEffect.html">FeatureEffect</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  <span class="va">predictor</span>,
  <span class="va">feature</span>,
  method <span class="op">=</span> <span class="st">"ale"</span>,
  center.at <span class="op">=</span> <span class="cn">NULL</span>,
  grid.size <span class="op">=</span> <span class="fl">20</span>,
  grid.points <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>predictor</code></dt>
<dd><p><a href="Predictor.html">Predictor</a><br>
The object (created with <code>Predictor$new()</code>) holding the machine
learning model and the data.</p></dd>


<dt><code>feature</code></dt>
<dd><p>(<code>character(1)</code> | <code>character(2)</code> | <code>numeric(1)</code> |
<code>numeric(2)</code>)<br>
The feature name or index for which to compute the effects.</p></dd>


<dt><code>method</code></dt>
<dd><p>(<code>character(1)</code>)<br></p><ul><li><p>'ale' for accumulated local effects,</p></li>
<li><p>'pdp' for partial dependence plot,</p></li>
<li><p>'ice' for individual conditional expectation curves,</p></li>
<li><p>'pdp + ice' for partial dependence plot and ice curves within the same
plot.</p></li>
</ul></dd>


<dt><code>center.at</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
Value at which the plot should be centered. Ignored in the case of two
features.</p></dd>


<dt><code>grid.size</code></dt>
<dd><p>(<code>numeric(1)</code> | <code>numeric(2)</code>)<br>
The size of the grid for evaluating the predictions.</p></dd>


<dt><code>grid.points</code></dt>
<dd><p>(<code>numeric() | list(numeric(), numeric())</code>)<br>
An optional grid along the feature. If grid.points are set, the grid.size
argument is ignored. Provide a list of two vectors with the same order as
in the 'feature' argument, if PDP/ALE for two features is to be computed
with a user-defined grid.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-set.feature"></a><div class="section">
<h3 id="method-set-feature-">Method <code>set.feature()</code><a class="anchor" aria-label="anchor" href="#method-set-feature-"></a></h3>
<p>Get/set feature(s) (by index) for which to compute PDP.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span class="va">FeatureEffect</span><span class="op">$</span><span class="fu">set.feature</span><span class="op">(</span><span class="va">feature</span><span class="op">)</span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>feature</code></dt>
<dd><p>(<code>character(1)</code>)<br>
Feature name.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-center"></a><div class="section">
<h3 id="method-center-">Method <code>center()</code><a class="anchor" aria-label="anchor" href="#method-center-"></a></h3>
<p>Set the value at which the ice computations are centered.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span class="va">FeatureEffect</span><span class="op">$</span><span class="fu">center</span><span class="op">(</span><span class="va">center.at</span><span class="op">)</span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>center.at</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
Value at which the plot should be centered. Ignored in the case of two
features.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-predict"></a><div class="section">
<h3 id="method-predict-">Method <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code><a class="anchor" aria-label="anchor" href="#method-predict-"></a></h3>
<p>Predict the marginal outcome given a feature.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span class="va">FeatureEffect</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">data</span>, extrapolate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>data</code></dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a><br>
Data.frame with the feature or a vector.</p></dd>


<dt><code>extrapolate</code></dt>
<dd><p>(<code>character(1)</code>)<br>
If TRUE, predict returns NA for x values outside of observed range.
If FALSE, predcit returns the closest PDP value for x values outside the range.
Ignored for categorical features</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>Values of the effect curves at the given values.</p>
</div>

</div><p></p><hr><a id="method-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span class="va">FeatureEffect</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># We train a random forest on the Boston dataset:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Boston"</span>, package <span class="op">=</span> <span class="st">"MASS"</span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/bethatkinson/rpart" class="external-link">"rpart"</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html" class="external-link">rpart</a></span><span class="op">(</span><span class="va">medv</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Boston</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va"><a href="Predictor.html">Predictor</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">rf</span>, data <span class="op">=</span> <span class="va">Boston</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Compute the accumulated local effects for the first feature</span></span>
<span class="r-in"><span class="va">eff</span> <span class="op">&lt;-</span> <span class="va">FeatureEffect</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, feature <span class="op">=</span> <span class="st">"rm"</span>, grid.size <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span class="r-in"><span class="va">eff</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureEffect-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Again, but this time with a partial dependence plot and ice curves</span></span>
<span class="r-in"><span class="va">eff</span> <span class="op">&lt;-</span> <span class="va">FeatureEffect</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>,</span>
<span class="r-in">  feature <span class="op">=</span> <span class="st">"rm"</span>, method <span class="op">=</span> <span class="st">"pdp+ice"</span>,</span>
<span class="r-in">  grid.size <span class="op">=</span> <span class="fl">30</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureEffect-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Since the result is a ggplot object, you can extend it:</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="co"># Adds a title</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Partial dependence"</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="co"># Adds original predictions</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span class="r-in">    data <span class="op">=</span> <span class="va">Boston</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mod</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">Boston</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, x <span class="op">=</span> <span class="va">rm</span><span class="op">)</span>,</span>
<span class="r-in">    color <span class="op">=</span> <span class="st">"pink"</span>, size <span class="op">=</span> <span class="fl">0.5</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureEffect-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># If you want to do your own thing, just extract the data:</span></span>
<span class="r-in"><span class="va">eff.dat</span> <span class="op">&lt;-</span> <span class="va">eff</span><span class="op">$</span><span class="va">results</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">eff.dat</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         rm   .value .type .id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3.561000 19.58263   pdp  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 3.740966 19.58263   pdp  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 3.920931 19.58263   pdp  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 4.100897 19.58263   pdp  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 4.280862 19.58263   pdp  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 4.460828 19.58263   pdp  NA</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># You can also use the object to "predict" the marginal values.</span></span>
<span class="r-in"><span class="va">eff</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">Boston</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 22.30267 19.58263 27.44788</span>
<span class="r-in"><span class="co"># Instead of the entire data.frame, you can also use feature values:</span></span>
<span class="r-in"><span class="va">eff</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19.58263 19.58263 27.44788</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># You can reuse the pdp object for other features:</span></span>
<span class="r-in"><span class="va">eff</span><span class="op">$</span><span class="fu">set.feature</span><span class="op">(</span><span class="st">"lstat"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureEffect-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Only plotting the aggregated partial dependence:</span></span>
<span class="r-in"><span class="va">eff</span> <span class="op">&lt;-</span> <span class="va">FeatureEffect</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, feature <span class="op">=</span> <span class="st">"crim"</span>, method <span class="op">=</span> <span class="st">"pdp"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">eff</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureEffect-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Only plotting the individual conditional expectation:</span></span>
<span class="r-in"><span class="va">eff</span> <span class="op">&lt;-</span> <span class="va">FeatureEffect</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, feature <span class="op">=</span> <span class="st">"crim"</span>, method <span class="op">=</span> <span class="st">"ice"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">eff</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureEffect-6.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Accumulated local effects and partial dependence plots support up to two</span></span>
<span class="r-in"><span class="co"># features:</span></span>
<span class="r-in"><span class="va">eff</span> <span class="op">&lt;-</span> <span class="va">FeatureEffect</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, feature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"crim"</span>, <span class="st">"lstat"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: yaImpute</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureEffect-7.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># FeatureEffect plots also works with multiclass classification</span></span>
<span class="r-in"><span class="va">rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html" class="external-link">rpart</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va"><a href="Predictor.html">Predictor</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">rf</span>, data <span class="op">=</span> <span class="va">iris</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># For some models we have to specify additional arguments for the predict</span></span>
<span class="r-in"><span class="co"># function</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">FeatureEffect</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, feature <span class="op">=</span> <span class="st">"Petal.Width"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureEffect-8.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># FeatureEffect plots support up to two features:</span></span>
<span class="r-in"><span class="va">eff</span> <span class="op">&lt;-</span> <span class="va">FeatureEffect</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, feature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sepal.Length"</span>, <span class="st">"Petal.Length"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">eff</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureEffect-9.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># show where the actual data lies</span></span>
<span class="r-in"><span class="va">eff</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span>show.data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureEffect-10.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># For multiclass classification models, you can choose to only show one class:</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va"><a href="Predictor.html">Predictor</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">rf</span>, data <span class="op">=</span> <span class="va">iris</span>, type <span class="op">=</span> <span class="st">"prob"</span>, class <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">FeatureEffect</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, feature <span class="op">=</span> <span class="st">"Sepal.Length"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureEffect-11.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christoph Molnar, <a href="https://pat-s.me" class="external-link">Patrick Schratz</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

