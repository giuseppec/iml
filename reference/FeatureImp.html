<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Feature importance — FeatureImp • iml</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Feature importance — FeatureImp"><meta property="og:description" content="FeatureImp computes feature importance for prediction models. The
importance is measured as the factor by which the model's prediction error
increases when the feature is shuffled."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">iml</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/intro.html">Introduction to iml: Interpretable Machine Learning in R</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallel computation of interpretation methods</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/christophM/iml/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Feature importance</h1>
    <small class="dont-index">Source: <a href="https://github.com/christophM/iml/blob/HEAD/R/FeatureImp.R" class="external-link"><code>R/FeatureImp.R</code></a></small>
    <div class="hidden name"><code>FeatureImp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>FeatureImp</code> computes feature importance for prediction models. The
importance is measured as the factor by which the model's prediction error
increases when the feature is shuffled.</p>
    </div>


    <div id="details">
    <h2>Details</h2>
    <p>To compute the feature importance for a single feature, the model prediction
loss (error) is measured before and after shuffling the values of the
feature. By shuffling the feature values, the association between the outcome
and the feature is destroyed. The larger the increase in prediction error,
the more important the feature was. The shuffling is repeated to get more
accurate results, since the permutation feature importance tends to be quite
unstable.
Read the Interpretable Machine Learning book to learn about feature
importance in detail:
<a href="https://christophm.github.io/interpretable-ml-book/feature-importance.html" class="external-link">https://christophm.github.io/interpretable-ml-book/feature-importance.html</a></p>
<p>The loss function can be either specified via a string, or by handing a
function to <code>FeatureImp()</code>. If you want to use your own loss function it
should have this signature:</p><div class="sourceCode"><pre><code>function(actual, predicted)
</code></pre></div>

<p>Using the string is
a shortcut to using loss functions from the <code>Metrics</code> package. Only use
functions that return a single performance value, not a vector. Allowed
losses are: <code>"ce"</code>, <code>"f1"</code>, <code>"logLoss"</code>, <code>"mae"</code>, <code>"mse"</code>, <code>"rmse"</code>, <code>"mape"</code>,
<code>"mdae"</code>, <code>"msle"</code>, <code>"percent_bias"</code>, <code>"rae"</code>, <code>"rmse"</code>, <code>"rmsle"</code>, <code>"rse"</code>,
<code>"rrse"</code> and <code>"smape"</code>.</p>
<p>See <code><a href="https://rdrr.io/r/base/library.html" class="external-link">library(help = "Metrics")</a></code> to get a list of functions.</p>
    </div>
    <div id="parallelization">
    <h2>Parallelization</h2>
    

<p>Parallelization is supported via package <a href="https://CRAN.R-project.org/package=future" class="external-link"><span class="pkg">future</span></a>.
To initialize future-based parallelization, select an appropriate backend and
specify the amount of workers.
For example, to use a PSOCK based cluster backend do:</p><div class="r"><div class="sourceCode"><pre><code>future::plan(multisession, workers = 2)
&lt;iml function here&gt;
</code></pre></div><p></p></div>
<p>Consult the resources of the <a href="https://CRAN.R-project.org/package=future" class="external-link"><span class="pkg">future</span></a> package for more parallel
backend options.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Fisher, A., Rudin, C., and Dominici, F. (2018). Model Class Reliance:
Variable Importance Measures for any Machine Learning Model Class, from the
"Rashomon" Perspective. Retrieved from http://arxiv.org/abs/1801.01489</p>
    </div>
    <div id="super-class">
    <h2>Super class</h2>
    <p><code><a href="InterpretationMethod.html">iml::InterpretationMethod</a></code> -&gt; <code>FeatureImp</code></p>
    </div>
    <div id="public-fields">
    <h2>Public fields</h2>
    <p></p><div class="r6-fields"><dl><dt><code>loss</code></dt>
<dd><p>(<code>character(1)</code> | <a href="https://rdrr.io/r/base/function.html" class="external-link">function</a>)<br>
The loss function. Either the name of a loss (e.g. <code>"ce"</code> for
classification or <code>"mse"</code>) or a function.</p></dd>


<dt><code>original.error</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
The loss of the model before perturbing features.</p></dd>


<dt><code>n.repetitions</code></dt>
<dd><p><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a><br>
Number of repetitions.</p></dd>


<dt><code>compare</code></dt>
<dd><p>(<code>character(1)</code>)<br> Either <code>"ratio"</code> or <code>"difference"</code>,
depending on whether the importance was calculated as difference
between original model error and model error after permutation or as
ratio.</p></dd>


<dt><code>features</code></dt>
<dd><p>(<code>list</code>)<br> Features for which importance scores are to
be calculated. The names are the feature/group names, while the contents
specify which feature(s) are to be permuted.</p></dd>


</dl><p></p></div>
    </div>
    <div id="methods">
    <h2>Methods</h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-new"><code>FeatureImp$new()</code></a></p></li>
<li><p><a href="#method-clone"><code>FeatureImp$clone()</code></a></p></li>
</ul></div><p><details open><summary>Inherited methods</summary><ul><li><p><span class="pkg-link" data-pkg="iml" data-topic="InterpretationMethod" data-id="plot"><a href="InterpretationMethod.html#method-plot"><code>iml::InterpretationMethod$plot()</code></a></span></p></li>
<li><p><span class="pkg-link" data-pkg="iml" data-topic="InterpretationMethod" data-id="print"><a href="InterpretationMethod.html#method-print"><code>iml::InterpretationMethod$print()</code></a></span></p></li>
</ul></details></p><hr><a id="method-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create a FeatureImp object</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span class="va"><a href="../reference/FeatureImp.html">FeatureImp</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  <span class="va">predictor</span>,
  <span class="va">loss</span>,
  compare <span class="op">=</span> <span class="st">"ratio"</span>,
  n.repetitions <span class="op">=</span> <span class="fl">5</span>,
  features <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>predictor</code></dt>
<dd><p><a href="Predictor.html">Predictor</a><br>
The object (created with <code>Predictor$new()</code>) holding the machine
learning model and the data.</p></dd>


<dt><code>loss</code></dt>
<dd><p>(<code>character(1)</code> | <a href="https://rdrr.io/r/base/function.html" class="external-link">function</a>)<br>
The loss function. Either the name of a loss (e.g. <code>"ce"</code> for
classification or <code>"mse"</code>) or a function. See Details for allowed
losses.</p></dd>


<dt><code>compare</code></dt>
<dd><p>(<code>character(1)</code>)<br>
Either <code>"ratio"</code> or <code>"difference"</code>.
Should importance be measured as the difference or as the ratio of
original model error and model error after permutation?</p><ul><li><p>Ratio: error.permutation/error.orig</p></li>
<li><p>Difference: error.permutation - error.orig</p></li>
</ul></dd>


<dt><code>n.repetitions</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
How often should the shuffling of the feature be repeated?
The higher the number of repetitions the more stable and accurate the
results become.</p></dd>


<dt><code>features</code></dt>
<dd><p>(<code>character or list</code>)<br>
For which features do you want importance scores calculated. The default
value of <code>NULL</code> implies all features. Use a named list of character vectors
to define groups of features for which joint importance will be calculated.
See examples.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>(data.frame)<br>
data.frame with the results of the feature importance computation. One
row per feature with the following columns:</p><ul><li><p>importance.05 (5% quantile of importance values from the repetitions)</p></li>
<li><p>importance (median importance)</p></li>
<li><p>importance.95 (95% quantile) and the permutation.error (median error
over all repetitions).</p></li>
</ul><p>The distribution of the importance is also visualized as a bar in the
plots, the median importance over the repetitions as a point.</p>
</div>

</div><p></p><hr><a id="method-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span class="va">FeatureImp</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/bethatkinson/rpart" class="external-link">"rpart"</a></span><span class="op">)</span></span>
<span class="r-in"><span class="co"># We train a tree on the Boston dataset:</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Boston"</span>, package <span class="op">=</span> <span class="st">"MASS"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html" class="external-link">rpart</a></span><span class="op">(</span><span class="va">medv</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Boston</span><span class="op">)</span></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Boston</span><span class="op">$</span><span class="va">medv</span></span>
<span class="r-in"><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">)</span> <span class="op">==</span> <span class="st">"medv"</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va"><a href="Predictor.html">Predictor</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">tree</span>, data <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Compute feature importances as the performance drop in mean absolute error</span></span>
<span class="r-in"><span class="va">imp</span> <span class="op">&lt;-</span> <span class="va">FeatureImp</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, loss <span class="op">=</span> <span class="st">"mae"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot the results directly</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imp</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureImp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Since the result is a ggplot object, you can extend it:</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imp</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureImp-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># If you want to do your own thing, just extract the data:</span></span>
<span class="r-in"><span class="va">imp.dat</span> <span class="op">&lt;-</span> <span class="va">imp</span><span class="op">$</span><span class="va">results</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">imp.dat</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   feature importance.05 importance importance.95 permutation.error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      rm      2.135926   2.157372      2.213222          6.277308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   lstat      1.875275   1.956849      1.973995          5.693847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     dis      1.147384   1.168364      1.196060          3.399590</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    crim      1.138652   1.154689      1.157714          3.359802</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      zn      1.000000   1.000000      1.000000          2.909702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   indus      1.000000   1.000000      1.000000          2.909702</span>
<span class="r-in"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">imp.dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">feature</span>, y <span class="op">=</span> <span class="va">importance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureImp-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># We can also look at the difference in model error instead of the ratio</span></span>
<span class="r-in"><span class="va">imp</span> <span class="op">&lt;-</span> <span class="va">FeatureImp</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, loss <span class="op">=</span> <span class="st">"mae"</span>, compare <span class="op">=</span> <span class="st">"difference"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot the results directly</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imp</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureImp-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># We can calculate feature importance for a subset of features </span></span>
<span class="r-in"><span class="va">imp</span> <span class="op">&lt;-</span> <span class="va">FeatureImp</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, loss <span class="op">=</span> <span class="st">"mae"</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"crim"</span>, <span class="st">"zn"</span>, <span class="st">"indus"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imp</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureImp-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># We can calculate joint importance of groups of features</span></span>
<span class="r-in"><span class="va">groups</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in"> grp1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"crim"</span>, <span class="st">"zn"</span>, <span class="st">"indus"</span>, <span class="st">"chas"</span><span class="op">)</span>,</span>
<span class="r-in"> grp2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nox"</span>, <span class="st">"rm"</span>, <span class="st">"age"</span>, <span class="st">"dis"</span><span class="op">)</span>,</span>
<span class="r-in"> grp3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rad"</span>, <span class="st">"tax"</span>, <span class="st">"ptratio"</span>, <span class="st">"black"</span>, <span class="st">"lstat"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">imp</span> <span class="op">&lt;-</span> <span class="va">FeatureImp</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, loss <span class="op">=</span> <span class="st">"mae"</span>, features <span class="op">=</span> <span class="va">groups</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imp</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureImp-6.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># FeatureImp also works with multiclass classification.</span></span>
<span class="r-in"><span class="co"># In this case, the importance measurement regards all classes</span></span>
<span class="r-in"><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html" class="external-link">rpart</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span class="r-in"><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span> <span class="op">==</span> <span class="st">"Species"</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va"><a href="Predictor.html">Predictor</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">tree</span>, data <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">y</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># For some models we have to specify additional arguments for the predict function</span></span>
<span class="r-in"><span class="va">imp</span> <span class="op">&lt;-</span> <span class="va">FeatureImp</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, loss <span class="op">=</span> <span class="st">"ce"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imp</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureImp-7.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># For multiclass classification models, you can choose to only compute</span></span>
<span class="r-in"><span class="co"># performance for one class.</span></span>
<span class="r-in"><span class="co"># Make sure to adapt y</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va"><a href="Predictor.html">Predictor</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">tree</span>,</span>
<span class="r-in">  data <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="va">y</span> <span class="op">==</span> <span class="st">"virginica"</span>,</span>
<span class="r-in">  type <span class="op">=</span> <span class="st">"prob"</span>, class <span class="op">=</span> <span class="st">"virginica"</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">imp</span> <span class="op">&lt;-</span> <span class="va">FeatureImp</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, loss <span class="op">=</span> <span class="st">"ce"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">imp</span><span class="op">)</span></span>
<span class="r-plt img"><img src="FeatureImp-8.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Christoph Molnar, <a href="https://pat-s.me" class="external-link">Patrick Schratz</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

