<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>LocalModel — LocalModel • iml</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="LocalModel — LocalModel"><meta property="og:description" content="LocalModel fits locally weighted linear regression models (logistic
regression for classification) to explain single predictions of a prediction
model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">iml</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.11.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/intro.html">Introduction to iml: Interpretable Machine Learning in R</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallel computation of interpretation methods</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/giuseppec/iml/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>LocalModel</h1>
    <small class="dont-index">Source: <a href="https://github.com/giuseppec/iml/blob/main/R/LocalModel.R" class="external-link"><code>R/LocalModel.R</code></a></small>
    <div class="hidden name"><code>LocalModel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>LocalModel</code> fits locally weighted linear regression models (logistic
regression for classification) to explain single predictions of a prediction
model.</p>
    </div>


    <div id="details">
    <h2>Details</h2>
    <p>A weighted glm is fitted with the machine learning model prediction as
target. Data points are weighted by their proximity to the instance to be
explained, using the gower proximity measure. L1-regularization is used to
make the results sparse.</p>
<p>The resulting model can be seen as a surrogate for the machine learning
model, which is only valid for that one point. Categorical features are
binarized, depending on the category of the instance to be explained: 1 if
the category is the same, 0 otherwise.</p>
<p>Please note that scaling continuous features in the machine learning method
might be advisable when using LIME as an interpretation technique. LIME uses
a distance measure to compute proximity weights for the weighted glm. Hence,
the original scale of the features may influence the distance measure and
therewith LIME results.</p>
<p>To learn more about local models, read the Interpretable Machine Learning
book: <a href="https://christophm.github.io/interpretable-ml-book/lime.html" class="external-link">https://christophm.github.io/interpretable-ml-book/lime.html</a></p>
<p>The approach is similar to LIME, but has the following differences:</p><ul><li><p><strong>Distance measure</strong>: Uses as default the gower proximity (= 1 - gower
distance) instead of a kernel based on the Euclidean distance. Has the
advantage to have a meaningful neighborhood and no kernel width to tune.
When the distance is not <code>"gower"</code>, then the <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist()</a></code> function with the
chosen method will be used, and turned into a similarity measure:
\(sqrt(exp(-(distance^2) / (kernel.width^2)))\).</p></li>
<li><p><strong>Sampling</strong>: Uses the original data instead of sampling from normal
distributions. Has the advantage to follow the original data distribution.</p></li>
<li><p><strong>Visualization</strong>: Plots effects instead of betas. Both are the same for binary
features, but ared different for numerical features. For numerical features,
plotting the betas makes no sense, because a negative beta might still
increase the prediction when the feature value is also negative.</p></li>
</ul><p>To learn more about local surrogate models, read the Interpretable Machine
Learning book:
<a href="https://christophm.github.io/interpretable-ml-book/lime.html" class="external-link">https://christophm.github.io/interpretable-ml-book/lime.html</a></p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Ribeiro, M. T., Singh, S., &amp; Guestrin, C. (2016). "Why Should I Trust You?":
Explaining the Predictions of Any Classifier. Retrieved from
http://arxiv.org/abs/1602.04938</p>
<p>Gower, J. C. (1971), "A general coefficient of similarity and some of its
properties". Biometrics, 27, 623–637.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plot.LocalModel.html">plot.LocalModel</a></code> and <code><a href="predict.LocalModel.html">predict.LocalModel</a></code></p>
<p><code><a href="Shapley.html">Shapley</a></code> can also be used to explain single predictions</p>
<p>The package <code>lime</code> with the original implementation</p></div>
    </div>
    <div id="super-class">
    <h2>Super class</h2>
    <p><code><a href="InterpretationMethod.html">iml::InterpretationMethod</a></code> -&gt; <code>LocalModel</code></p>
    </div>
    <div id="public-fields">
    <h2>Public fields</h2>
    <p></p><div class="r6-fields"><dl><dt><code>x.interest</code></dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a><br>
Single row with the instance to be explained.</p></dd>


<dt><code>k</code></dt>
<dd><p><code>numeric(1)</code><br>
The number of features as set by the user.</p></dd>


<dt><code>model</code></dt>
<dd><p><code>glmnet</code><br>
The fitted local model.</p></dd>


<dt><code>best.fit.index</code></dt>
<dd><p><code>numeric(1)</code><br>
The index of the best glmnet fit.</p></dd>


</dl><p></p></div>
    </div>
    <div id="methods">
    <h2>Methods</h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-LocalModel-new"><code>LocalModel$new()</code></a></p></li>
<li><p><a href="#method-LocalModel-predict"><code>LocalModel$predict()</code></a></p></li>
<li><p><a href="#method-LocalModel-explain"><code>LocalModel$explain()</code></a></p></li>
<li><p><a href="#method-LocalModel-clone"><code>LocalModel$clone()</code></a></p></li>
</ul></div><p><details open><summary>Inherited methods</summary><ul><li><span class="pkg-link" data-pkg="iml" data-topic="InterpretationMethod" data-id="plot"><a href="InterpretationMethod.html#method-plot"><code>iml::InterpretationMethod$plot()</code></a></span></li>
<li><span class="pkg-link" data-pkg="iml" data-topic="InterpretationMethod" data-id="print"><a href="InterpretationMethod.html#method-print"><code>iml::InterpretationMethod$print()</code></a></span></li>
</ul></details></p><hr><a id="method-LocalModel-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create a Local Model object.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/LocalModel.html">LocalModel</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">predictor</span>,</span>
<span>  <span class="va">x.interest</span>,</span>
<span>  dist.fun <span class="op">=</span> <span class="st">"gower"</span>,</span>
<span>  gower.power <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  kernel.width <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>predictor</code></dt>
<dd><p><a href="Predictor.html">Predictor</a><br>
The object (created with <code>Predictor$new()</code>) holding the machine
learning model and the data.</p></dd>


<dt><code>x.interest</code></dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a><br>
Single row with the instance to be explained.</p></dd>


<dt><code>dist.fun</code></dt>
<dd><p><code>character(1)</code>)<br>
The name of the distance function for computing proximities (weights in
the linear model). Defaults to <code>"gower"</code>. Otherwise will be forwarded
to <a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist</a>.</p></dd>


<dt><code>gower.power</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
The calculated gower proximity will be raised to the power of this
value. Can be used to specify the size of the neighborhood for the
LocalModel (similar to kernel.width for the euclidean distance).</p></dd>


<dt><code>kernel.width</code></dt>
<dd><p>(<code>numeric(1)</code>)<br>
The width of the kernel for the proximity computation.
Only used if dist.fun is not <code>"gower"</code>.</p></dd>


<dt><code>k</code></dt>
<dd><p><code>numeric(1)</code><br>
The number of features.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a><br>
Results with the feature names (<code>feature</code>) and contributions to the
prediction.</p>
</div>

</div><p></p><hr><a id="method-LocalModel-predict"></a><div class="section">
<h3 id="method-predict-">Method <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code><a class="anchor" aria-label="anchor" href="#method-predict-"></a></h3>
<p>Method to predict new data with the local model See also
<a href="predict.LocalModel.html">predict.LocalModel</a>.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">LocalModel</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span>newdata <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>newdata</code></dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a><br>
Data to predict on.</p></dd>


<dt><code>...</code></dt>
<dd><p>Not used</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-LocalModel-explain"></a><div class="section">
<h3 id="method-explain-">Method <code>explain()</code><a class="anchor" aria-label="anchor" href="#method-explain-"></a></h3>
<p>Set a new data point to explain.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">LocalModel</span><span class="op">$</span><span class="fu">explain</span><span class="op">(</span><span class="va">x.interest</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>x.interest</code></dt>
<dd><p><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a><br>
Single row with the instance to be explained.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-LocalModel-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">LocalModel</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/" class="external-link">"randomForest"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># First we fit a machine learning model on the Boston housing data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Boston"</span>, package <span class="op">=</span> <span class="st">"MASS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Boston</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Boston</span><span class="op">)</span> <span class="op">==</span> <span class="st">"medv"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span><span class="op">(</span><span class="va">medv</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Boston</span>, ntree <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va"><a href="Predictor.html">Predictor</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">rf</span>, data <span class="op">=</span> <span class="va">X</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Explain the first instance of the dataset with the LocalModel method:</span></span></span>
<span class="r-in"><span><span class="va">x.interest</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">lemon</span> <span class="op">&lt;-</span> <span class="va">LocalModel</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, x.interest <span class="op">=</span> <span class="va">x.interest</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: glmnet</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: Matrix</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loaded glmnet 4.1-8</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: gower</span>
<span class="r-in"><span><span class="va">lemon</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Interpretation method:  LocalModel </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysed predictor: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction task: unknown </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysed data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling from data.frame with 506 rows and 13 columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Head of results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             beta x.recoded    effect x.original feature feature.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rm     2.9291022     6.575 19.258847      6.575      rm      rm=6.575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lstat -0.3074272     4.980 -1.530987       4.98   lstat    lstat=4.98</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Look at the results in a table</span></span></span>
<span class="r-in"><span><span class="va">lemon</span><span class="op">$</span><span class="va">results</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             beta x.recoded    effect x.original feature feature.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rm     2.9291022     6.575 19.258847      6.575      rm      rm=6.575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lstat -0.3074272     4.980 -1.530987       4.98   lstat    lstat=4.98</span>
<span class="r-in"><span><span class="co"># Or as a plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lemon</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="LocalModel-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Reuse the object with a new instance to explain</span></span></span>
<span class="r-in"><span><span class="va">lemon</span><span class="op">$</span><span class="va">x.interest</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      crim zn indus chas   nox    rm  age  dis rad tax ptratio black lstat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.00632 18  2.31    0 0.538 6.575 65.2 4.09   1 296    15.3 396.9  4.98</span>
<span class="r-in"><span><span class="va">lemon</span><span class="op">$</span><span class="fu">explain</span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lemon</span><span class="op">$</span><span class="va">x.interest</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      crim zn indus chas   nox    rm  age    dis rad tax ptratio black lstat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.02731  0  7.07    0 0.469 6.421 78.9 4.9671   2 242    17.8 396.9  9.14</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lemon</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="LocalModel-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># LocalModel also works with multiclass classification</span></span></span>
<span class="r-in"><span><span class="va">rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">iris</span>, ntree <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">iris</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span> <span class="op">==</span> <span class="st">"Species"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="va"><a href="Predictor.html">Predictor</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">rf</span>, data <span class="op">=</span> <span class="va">X</span>, type <span class="op">=</span> <span class="st">"prob"</span>, class <span class="op">=</span> <span class="st">"setosa"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Then we explain the first instance of the dataset with the LocalModel method:</span></span></span>
<span class="r-in"><span><span class="va">lemon</span> <span class="op">&lt;-</span> <span class="va">LocalModel</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">mod</span>, x.interest <span class="op">=</span> <span class="va">X</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lemon</span><span class="op">$</span><span class="va">results</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    beta x.recoded     effect x.original      feature</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Width   0.1769011       3.5  0.6191539        3.5  Sepal.Width</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length -0.2160048       1.4 -0.3024067        1.4 Petal.Length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 feature.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sepal.Width   Sepal.Width=3.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length Petal.Length=1.4</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lemon</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="LocalModel-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Giuseppe Casalicchio, Christoph Molnar, <a href="https://pat-s.me" class="external-link">Patrick Schratz</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

